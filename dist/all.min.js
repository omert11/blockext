(()=>{"use strict";var t;!function(t){t.each="each",t.block="block",t.helper="helper"}(t||(t={}));const e=(()=>{let t=0;return()=>(t++,t-1)})(),r=[],a={get registry(){return[...r]},add(t){r.push(t)},get_tag_methods:t=>a.registry.filter((e=>t.includes(e.name)))};a.add(function(t){const r=r=>{const a={id:e(),name:t.name,type:t.type,el:r.el,context:r.context,get_html_attribute:t=>t.getAttribute(`bx-${a.name}`),get_data:(t,e)=>(t.split(".").forEach((t=>e=e[t])),e),remove_tag_attribute:()=>a.el.removeAttribute(a.attr),use:()=>({break_loop:!1,context:a.context,...t.use.call(a)}),clean(){if(t.clean)return t.clean.call(a)},get attr(){return a.get_html_attribute(a.el)},get data(){return a.get_data(a.attr,a.context)}};return a};return r._name=t.name,r._type=t.type,r}({name:"for",type:t.each,use(){this.base_attr=this.attr;let t=this.data;Array.isArray(t)||(t=[t]),this.remove_tag();const e=this.el.setAttribute("bx-each-id",this.tag_id),r=this.el.outerHTML;return this.loop_html=r,{break_loop:!1,context:null,each_method(a,o,l,s){for(let a=0;a<t.length;a++){let o={...t[a],"bx-for-counter":a+1,"bx-for-counter0":a,"bx-for-first":0==a,"bx-for-last":a==t.length-1},i=r.insertAfter(e);l.call(s,a,i,o)}e.remove()}}},clean(){}})),globalThis.BlockExt=class{constructor(t){let e=null;if("string"==typeof t){if(e=document.querySelector(t),!e)throw Error(`No element found in the dom with selector '${t}'.`)}else e=t;this.el=e,this.main_elements=this.el.querySelectorAll("[bx-main]"),this.tag_instances=[],this.collect_tags(this.el)}collect_tags(t,e=/bx-(.*?)="(.*?)"/g){let r=Array.from(t.outerHTML.matchAll(e)),o=[];r.forEach((t=>{o.includes(t[0])||o.push(t[0])})),this.used_tags=o,this.tags=a.get_tag_methods(this.used_tags)}get_filtered_TAGS(t){return this[`__${t}_tag_cache`]||(this[`__${t}_tag_cache`]=this.tags.filter((e=>e._type==t))),this[`__${t}_tag_cache`]}*get_TAG_iter(t,e,r){for(const a of r)if(t.getAttribute(`bx-${a.name}`)){const r=a({el:t,context:e});yield r}}get each_tags(){return this.get_filtered_TAGS(t.each)}get_each_tags(t,e){return this.get_TAG_iter(t,e,this.each_tags)}main_loop(t){function e(t,e,r,a){t.childNodes.forEach(((t,o)=>r.call(a,o,t,e)))}this.main_elements.forEach((r=>this.top_loop(r,t,e)))}top_loop(t,e,r){r(t,e,this.loop,this)}loop(t,e,r){let a=this.do_each(e,r);this.top_loop(e,r,a.each_method)}do_each(t,e){let r=this.get_each_tags(t,e).next().value;return r?r.use():{break_loop:!1,context:e}}}})();